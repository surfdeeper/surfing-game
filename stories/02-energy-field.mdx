# Energy Field Propagation

The energy field uses a row-blending algorithm to propagate energy from
horizon (row 0) toward shore (row N). Each frame, cells blend with the
row above them at a rate determined by `travelDuration`.

import { ProgressionPlayer, ProgressionStrip } from './components/ProgressionPlayer';
import {
  PROGRESSION_NO_DAMPING,
  PROGRESSION_LOW_DAMPING,
  PROGRESSION_HIGH_DAMPING,
  PROGRESSION_WITH_DRAIN,
  ENERGY_FIELD_STRIP_NO_DAMPING,
  ENERGY_FIELD_STRIP_LOW_DAMPING,
  ENERGY_FIELD_STRIP_HIGH_DAMPING,
  ENERGY_FIELD_STRIP_WITH_DRAIN,
} from '../src/state/energyFieldProgressions';

<section id="no-damping">

## No Damping (Deep Water)

In deep water, waves translate without spreading or losing energy.
The pulse moves as a sharp horizontal line from horizon toward shore.

<ProgressionPlayer snapshots={PROGRESSION_NO_DAMPING.snapshots} />

<ProgressionStrip snapshots={ENERGY_FIELD_STRIP_NO_DAMPING.snapshots} testId={ENERGY_FIELD_STRIP_NO_DAMPING.testId} />

**Key observations:**
- Energy moves down one row per second as a sharp line
- No vertical spreading - the line stays crisp
- Total energy is conserved (1.0 at all times)

</section>

<section id="low-damping">

## Low Damping

Coefficient `0.05` — subtle fade near shore, prevents energy buildup at shoreline.

<ProgressionPlayer snapshots={PROGRESSION_LOW_DAMPING.snapshots} />

<ProgressionStrip snapshots={ENERGY_FIELD_STRIP_LOW_DAMPING.snapshots} testId={ENERGY_FIELD_STRIP_LOW_DAMPING.testId} />

</section>

<section id="high-damping">

## High Damping

Coefficient `2.0` — energy mostly gone before reaching shore. Too much damping makes waves feel weak.

<ProgressionPlayer snapshots={PROGRESSION_HIGH_DAMPING.snapshots} />

<ProgressionStrip snapshots={ENERGY_FIELD_STRIP_HIGH_DAMPING.snapshots} testId={ENERGY_FIELD_STRIP_HIGH_DAMPING.testId} />

</section>

<section id="energy-drain">

## Energy Drain (Wave Breaking)

When a wave breaks, `drainEnergyAt()` removes energy from the field at
that location. The drained energy is converted to foam via the
`energyTransferGrid`.

```js
// Drain energy at normalized position (x, y)
const drained = drainEnergyAt(field, 0.5, 0.5, amount);
// Returns actual amount drained (may be less if insufficient energy)
```

This progression shows energy propagating normally, then at t=1s the
center column is completely drained (simulating wave breaking):

<ProgressionPlayer snapshots={PROGRESSION_WITH_DRAIN.snapshots} />

<ProgressionStrip snapshots={ENERGY_FIELD_STRIP_WITH_DRAIN.snapshots} testId={ENERGY_FIELD_STRIP_WITH_DRAIN.testId} />

**What to look for:**
- t=0s: Full energy pulse at horizon
- t=1s (drain): Center column drops to 0, neighbors retain energy
- t=2s+: Hole persists as energy continues propagating

The contrast between center (0.0) and neighbors (0.3-0.5) demonstrates
how breaking creates localized energy depletion.

</section>
